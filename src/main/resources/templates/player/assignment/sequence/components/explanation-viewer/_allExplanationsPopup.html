<div th:fragment="allExplanationsPopup(sequenceId,explanationViewerModel)"
     th:with="components=${'/player/assignment/sequence/components/explanation-viewer'}"
     th:remove="tag"
     xmlns:th="http://www.thymeleaf.org" xmlns="http://www.w3.org/1999/html">

  <button type="button"
          class="ui button"
          th:onclick="|$('#all_explanations_for_${sequenceId}').modal('show');|"
          th:text="#{player.sequence.explanation.all.button}">
    See all explanations
  </button>

  <div th:id="|all_explanations_for_${sequenceId}|"
       class="ui modal"
       tabindex="-1" role="dialog"
       aria-hidden="true">

    <div class="header" th:text="#{player.sequence.explanation.all}">
      All explanations...
    </div>

    <div class="scrolling content">

      <div th:if="${explanationViewerModel.hasChoice}">
        <div class="ui styled fluid accordion" th:id="|accordion-explanation-viewer-${sequenceId}|">
          <div
            th:replace="|${components}/_responseTab|::responseTab(${true}, ${explanationViewerModel.correctResponse}, ${explanationViewerModel.explanationsForCorrectResponse})"></div>

          <div th:each="explanationsByResponse, i : ${explanationViewerModel.explanationsByIncorrectResponses}"
               th:remove="tag">
            <div
              th:replace="|${components}/_responseTab|::responseTab(${false}, ${explanationsByResponse.key}, ${explanationsByResponse.value})"></div>
          </div>
        </div>
      </div>
      <div th:if="${!explanationViewerModel.hasChoice}">
        <div
          th:replace="|${components}/_explanationList|::explanationList(${explanationViewerModel.explanations})"></div>
      </div>
    </div>

    <div class="actions">
      <div class="ui cancel button" th:text="#{player.sequence.explanation.close.button}">Close</div>
    </div>
  </div>

  <script th:inline="javascript">
    $(document).ready(function () {
      let accordionId = /*[[|#accordion-explanation-viewer-${sequenceId}|]]*/ ''
      $(accordionId).accordion()
    })
  </script>

</div>